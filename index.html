<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Fim - File Integrity Manager</title>
  <meta name="description" content="Fim manage the integrity of a complete file tree." />

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-65608268-1', 'auto');
    ga('send', 'pageview');
  </script>

  <link href='http://fonts.googleapis.com/css?family=Roboto:400,500,700,900' rel='stylesheet' type='text/css'>

  <!-- Markdown text checked using http://www.onlinecorrection.com -->

</head>

<body>

<xmp style="display:none;" toc toc-top-link>

# <img src="images/logo.png" alt="Logo" style="width: 64px;"/> Presentation
---

Fim allow you to quickly get the status of all kind of files.<br/>
It can be photos, videos or a complete disk tree. You can manage them like you could do with a VCS like Git.

On a daily workflow, you can know the files that have been added, modified, removed, moved, renamed, duplicated.<br/>
When you are working with files and you are also very busy, it's difficult to remind what are the files you were working on previously.<br/>
A VCS can help you find it.<br/>
Unfortunately when you are working with photos or videos, or other kind of big binary files you cannot manage them with a VCS like Git.<br/>
Fim is here for that.

Each time you have a stable state you can commit to store it and be able to compare it with the next state later.

The big difference with Git is that Fim does not keep track of the different contents of the files that are managed.<br/>
This is why we can call it an Unversioned Control System (UVCS).<br/>

Fim is able to manage hundreds of thousands of files with a total size of several terabytes.<br/>
This kind of file tree could not be managed by Git.<br/>

Using Fim you can also easily detect duplicates and remove them.

<br/>
<br/>

# How does it works
---

Fim manages an index of the files that are managed. It contains for each file:

- file name
- file length
- modification date
- hash of the second 4 KB block of the file content
- hash of the second 1 MB block of the file content
- hash of the full file content

Most of the files contains headers, so to produce accurate hash of 4 KB / 1 MB blocs we skip the first block and hash the second one,<br/>
**but when the file size is less than twice the block size we hash the first block**.

The hash algorithm that is used is SHA-512.

This index is called a `State` and acts like the Central Directory does for a Zip file.
All the data generated by Fim is stored into the `.fim` root directory.

Fim keeps each version of the different State that have been committed.
You cannot use them to retrieve the content of one file that you may have lost.

> __Fim does not replace a backup software__

<br/>
<br/>

# Fim workflow
---

First you need to initialize the Fim repository using the `init` command.
This will record the first State of your file tree.

```shell
$ fim init
```

Then you can compare the differences between the recorded State and the current file tree using the diff command.
You can do a full diff that will compare the hash of all the files. It can be very slow as all the files content will be read.

```shell
$ fim diff
```

You can compare quickly asking to hash only the second 1 MB block of the files. **Using this option can produce an inaccurate result.**

```shell
$ fim diff -m
```

You can compare quicker asking to hash only the second 4 KB block of the files. **Using this option can produce an inaccurate result.**

```shell
$ fim diff -k
```

Otherwise, you can request to not hash file content using the fast mode (-f option). It will compare only the file names and modification dates.
You will not be able to detect files that have been renamed or duplicated.

```shell
$ fim diff -f
```

Each time you want to record the State of the current file tree you can use the commit command.
It's a time consuming operation that will compute all the hash of each files content.

```shell
$ fim ci
```

<br/>
<br/>

# Fim usage
---

```shell
$ fim help

usage: fim <command> [-a <arg>] [-c <arg>] [-f] [-h] [-k] [-l] [-m] [-q] [-t <arg>] [-v] [-y]

File Integrity Checker

Available commands:
     init                       Initialize a Fim repository
     ci / commit                Commit the current directory State
     diff                       Compare the current directory State with the previous one
     rdate / reset-date         Reset the files modification date like it is stored in the last committed State
     fdup / find-duplicates     Find local duplicated files in the Fim repository
     rdup / remove-duplicates   Remove duplicated files from local directory based on a remote master Fim repository
     log                        Display States log
     purge / purge-states       Purge previous States
     help                       Prints the Fim help
     version                    Prints the Fim version

Available options:
     -a,--master-fim-repository <arg>   Fim repository directory that you want to use as remote master.
                                        Only for the remove duplicated files command
     -c,--comment <arg>                 Sets that State comment during init and commit
     -f,--fast-mode                     Do not hash file content. Use only file names and modification dates
     -h,--help                          Prints the Fim help
     -k,--hash-second-4-kb-block        Hash the second 4 KB block of the files
     -l,--use-last-state                Use the last committed State.
                                        Only for the find local duplicated files command
     -m,--hash-second-1-mb-block        Hash the second 1 MB block of the files
     -q,--quiet                         Do not display details
     -t,--thread-count <arg>            Number of thread used to hash files content in parallel
     -v,--version                       Prints the Fim version
     -y,--always-yes                    Always yes to every questions
```

<br/>
<br/>

# How can I use Fim
---

## Fim releases

You can find prebuilt releases of Fim [here](https://github.com/evrignaud/fim/releases)

<br/>

## Build Fim

You can build yourself Fim to try the master version.

- Get the code

	- Download the [.zip](https://github.com/evrignaud/fim/zipball/master) or the [.tar.gz](https://github.com/evrignaud/fim/tarball/master)
	- or clone it using either `https://github.com/evrignaud/fim.git` or `git@github.com:evrignaud/fim.git`


- build it by typing the following command:

```shell
mvn clean install
```

- You can run the jar file generated into the `target` directory using the two shell script files located in the root directory.<br/>

> `fim` for Linux<br/>
> `fim.bat` for Windows

<br/>

## Build a Fim distribution

If you want to generate a Fim distribution type the following command:

```shell
mvn clean install -Pdistrib
```

It generates two distribution files into the `target/dist` directory.

```shell
$ ls -a1 target/dist/
fim-1.0.0-SNAPSHOT-distribution.tar.gz
fim-1.0.0-SNAPSHOT-distribution.zip
```

<br/>
<br/>

# Changelog
---

Details regarding all the Fim releases are available in the [Changelog](http://evrignaud.github.io/fim/Changelog.html)

<br/>
<br/>

# Simple example
---

Here is a step by step example of Fim usage.
For the purpose of this example we use small files.

<br/>

## Create a set of files

```shell
~$ mkdir sample

~$ cd sample/

# Creates 10 files
~/sample$ for i in {01..10} ; do echo "New File $i" > file$i ; done

~/sample$ ls -la
total 56
drwxrwxr-x   2  4096 août  24 23:00 .
drwxr-xr-x 108 12288 août  24 22:18 ..
-rw-rw-r--   1    12 août  24 23:00 file01
-rw-rw-r--   1    12 août  24 23:00 file02
-rw-rw-r--   1    12 août  24 23:00 file03
-rw-rw-r--   1    12 août  24 23:00 file04
-rw-rw-r--   1    12 août  24 23:00 file05
-rw-rw-r--   1    12 août  24 23:00 file06
-rw-rw-r--   1    12 août  24 23:00 file07
-rw-rw-r--   1    12 août  24 23:00 file08
-rw-rw-r--   1    12 août  24 23:00 file09
-rw-rw-r--   1    12 août  24 23:00 file10
```

<br/>

## Initialize the Fim repository

```shell
~/sample$ fim init -c "First State"
2015/08/24 23:00:27 - Info  - Scanning recursively local files, hash the complete file, using 2 thread
(Hash progress legend for files grouped 10 by 10: # > 200 MB, @ > 100 MB, O > 50 MB, o > 20 MB, . otherwise)
.
2015/08/24 23:00:27 - Info  - Scanned 10 files (120 bytes), hashed 120 bytes (avg 120 bytes/s), during 00:00:00, using 2 thread

Added:            file01
Added:            file02
Added:            file03
Added:            file04
Added:            file05
Added:            file06
Added:            file07
Added:            file08
Added:            file09
Added:            file10

10 added
```

<br/>

## A new `.fim` directory have been created

```shell
~/sample$ ls -la
total 60
drwxrwxr-x   3  4096 août  24 23:00 .
drwxr-xr-x 108 12288 août  24 22:18 ..
-rw-rw-r--   1    12 août  24 23:00 file01
-rw-rw-r--   1    12 août  24 23:00 file02
-rw-rw-r--   1    12 août  24 23:00 file03
-rw-rw-r--   1    12 août  24 23:00 file04
-rw-rw-r--   1    12 août  24 23:00 file05
-rw-rw-r--   1    12 août  24 23:00 file06
-rw-rw-r--   1    12 août  24 23:00 file07
-rw-rw-r--   1    12 août  24 23:00 file08
-rw-rw-r--   1    12 août  24 23:00 file09
-rw-rw-r--   1    12 août  24 23:00 file10
drwxrwxr-x   3  4096 août  24 23:00 .fim
```

<br/>

## Do some modifications

```shell
~/sample$ mkdir dir01

# Move file01 to dir01
~/sample$ mv file01 dir01

# Change the file02 modification date
~/sample$ touch file02

# Duplicate twice file03
~/sample$ cp file03 file03.dup1
~/sample$ cp file03 file03.dup2

# Add content to file04
~/sample$ echo foo >> file04

# Copy file05
~/sample$ cp file05 file11

# And add content to it
~/sample$ echo bar >> file05

# Remove file06
~/sample$ rm file06

# Duplicate once file07
~/sample$ cp file07 file07.dup1

# Create the new file12
~/sample$ echo "New File 12" > file12

~/sample$ ls -la
total 76
drwxrwxr-x   4  4096 août  24 23:00 .
drwxr-xr-x 108 12288 août  24 22:18 ..
drwxrwxr-x   2  4096 août  24 23:00 dir01
-rw-rw-r--   1    12 août  24 23:00 file02
-rw-rw-r--   1    12 août  24 23:00 file03
-rw-rw-r--   1    12 août  24 23:00 file03.dup1
-rw-rw-r--   1    12 août  24 23:00 file03.dup2
-rw-rw-r--   1    16 août  24 23:00 file04
-rw-rw-r--   1    16 août  24 23:00 file05
-rw-rw-r--   1    12 août  24 23:00 file07
-rw-rw-r--   1    12 août  24 23:00 file07.dup1
-rw-rw-r--   1    12 août  24 23:00 file08
-rw-rw-r--   1    12 août  24 23:00 file09
-rw-rw-r--   1    12 août  24 23:00 file10
-rw-rw-r--   1    12 août  24 23:00 file11
-rw-rw-r--   1    12 août  24 23:00 file12
drwxrwxr-x   3  4096 août  24 23:00 .fim

~/sample$ ls -la dir01/
total 12
drwxrwxr-x 2 4096 août  24 23:00 .
drwxrwxr-x 4 4096 août  24 23:00 ..
-rw-rw-r-- 1   12 août  24 23:00 file01
```

<br/>

## Fim detects the modifications

```shell
~/sample$ fim diff
2015/08/24 23:00:28 - Info  - Scanning recursively local files, hash the complete file, using 2 thread
(Hash progress legend for files grouped 10 by 10: # > 200 MB, @ > 100 MB, O > 50 MB, o > 20 MB, . otherwise)
.
2015/08/24 23:00:28 - Info  - Scanned 14 files (176 bytes), hashed 176 bytes (avg 176 bytes/s), during 00:00:00, using 2 thread

Comparing with the last committed state from 2015/08/24 23:00:27
Comment: First State

Added:            file12
Copied:           file11 	(was file05)
Duplicated:       file03.dup1 = file03
Duplicated:       file03.dup2 = file03
Duplicated:       file07.dup1 = file07
Date modified:    file02 	2015/08/24 23:00:27 -> 2015/08/24 23:00:27
Content modified: file04 	2015/08/24 23:00:27 -> 2015/08/24 23:00:27
Content modified: file05 	2015/08/24 23:00:27 -> 2015/08/24 23:00:27
Renamed:          file01 -> dir01/file01
Deleted:          file06

1 added, 1 copied, 3 duplicated, 1 date modified, 2 content modified, 1 renamed, 1 deleted
```

<br/>

## Search for duplicated files

```shell
~/sample$ fim fdup
Searching for duplicated files

2015/08/24 23:00:29 - Info  - Scanning recursively local files, hash the complete file, using 2 thread
(Hash progress legend for files grouped 10 by 10: # > 200 MB, @ > 100 MB, O > 50 MB, o > 20 MB, . otherwise)
.
2015/08/24 23:00:29 - Info  - Scanned 14 files (176 bytes), hashed 176 bytes (avg 176 bytes/s), during 00:00:00, using 2 thread

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
- Duplicate set #1
  file07 duplicated 1 times
      12 bytes - file07.dup1

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
- Duplicate set #2
  file03 duplicated 2 times
      12 bytes - file03.dup1
      12 bytes - file03.dup2

3 duplicated files spread in 2 duplicate sets, 36 bytes of wasted space
```

<br/>

## From the `dir01` sub-directory

We can run Fim on a subset of the repository.

```shell
~/sample$ cd dir01
```

Inside this directory only one file is added.

```shell
~/sample/dir01$ fim diff
2015/08/24 23:00:29 - Info  - Scanning recursively local files, hash the complete file, using 2 thread
(Hash progress legend for files grouped 10 by 10: # > 200 MB, @ > 100 MB, O > 50 MB, o > 20 MB, . otherwise)
2015/08/24 23:00:30 - Info  - Scanned 1 files (12 bytes), hashed 12 bytes (avg 12 bytes/s), during 00:00:00, using 2 thread

Comparing with the last committed state from 2015/08/24 23:00:27
Comment: First State

Added:            dir01/file01

1 added
```

No duplicated files as we are looking only inside the `dir01`.

```shell
~/sample/dir01$ fim fdup
Searching for duplicated files

2015/08/24 23:00:30 - Info  - Scanning recursively local files, hash the complete file, using 2 thread
(Hash progress legend for files grouped 10 by 10: # > 200 MB, @ > 100 MB, O > 50 MB, o > 20 MB, . otherwise)
2015/08/24 23:00:31 - Info  - Scanned 1 files (12 bytes), hashed 12 bytes (avg 12 bytes/s), during 00:00:00, using 2 thread

0 duplicated files spread in 0 duplicate sets, 0 bytes of wasted space
```

Commit only the local modifications done inside this directory.

```shell
~/sample/dir01$ fim ci -c modifications from dir01 -y
2015/08/24 23:00:31 - Info  - Scanning recursively local files, hash the complete file, using 2 thread
(Hash progress legend for files grouped 10 by 10: # > 200 MB, @ > 100 MB, O > 50 MB, o > 20 MB, . otherwise)
2015/08/24 23:00:32 - Info  - Scanned 1 files (12 bytes), hashed 12 bytes (avg 12 bytes/s), during 00:00:00, using 2 thread

Comparing with the last committed state from 2015/08/24 23:00:27
Comment: First State

Added:            dir01/file01

1 added
```

No more local modifications.

```shell
~/sample/dir01$ fim diff
2015/08/24 23:00:32 - Info  - Scanning recursively local files, hash the complete file, using 2 thread
(Hash progress legend for files grouped 10 by 10: # > 200 MB, @ > 100 MB, O > 50 MB, o > 20 MB, . otherwise)
2015/08/24 23:00:33 - Info  - Scanned 1 files (12 bytes), hashed 12 bytes (avg 12 bytes/s), during 00:00:00, using 2 thread

Comparing with the last committed state from 2015/08/24 23:00:31
Comment: modifications from dir01

Nothing modified
```

```shell
~/sample/dir01$ cd ..
```

## Commit the modifications

```shell
~/sample$ fim ci -c All modifications -y
2015/08/24 23:00:33 - Info  - Scanning recursively local files, hash the complete file, using 2 thread
(Hash progress legend for files grouped 10 by 10: # > 200 MB, @ > 100 MB, O > 50 MB, o > 20 MB, . otherwise)
.
2015/08/24 23:00:33 - Info  - Scanned 14 files (176 bytes), hashed 176 bytes (avg 176 bytes/s), during 00:00:00, using 2 thread

Comparing with the last committed state from 2015/08/24 23:00:31
Comment: modifications from dir01

Added:            file12
Copied:           file11 	(was file05)
Duplicated:       file03.dup1 = file03
Duplicated:       file03.dup2 = file03
Duplicated:       file07.dup1 = file07
Date modified:    file02 	2015/08/24 23:00:27 -> 2015/08/24 23:00:27
Content modified: file04 	2015/08/24 23:00:27 -> 2015/08/24 23:00:27
Content modified: file05 	2015/08/24 23:00:27 -> 2015/08/24 23:00:27
Deleted:          file01
Deleted:          file06

1 added, 1 copied, 3 duplicated, 1 date modified, 2 content modified, 2 deleted
```

<br/>

## Nothing is modified now

```shell
~/sample$ fim diff
2015/08/24 23:00:34 - Info  - Scanning recursively local files, hash the complete file, using 2 thread
(Hash progress legend for files grouped 10 by 10: # > 200 MB, @ > 100 MB, O > 50 MB, o > 20 MB, . otherwise)
.
2015/08/24 23:00:34 - Info  - Scanned 14 files (176 bytes), hashed 176 bytes (avg 176 bytes/s), during 00:00:00, using 2 thread

Comparing with the last committed state from 2015/08/24 23:00:33
Comment: All modifications

Nothing modified
```

<br/>

## Display the Fim log

```shell
~/sample$ fim log
State #1: 2015/08/24 23:00:27 (10 files)
	Comment: First State
	10 added

State #2: 2015/08/24 23:00:31 (11 files)
	Comment: modifications from dir01
	1 added

State #3: 2015/08/24 23:00:33 (14 files)
	Comment: All modifications
	1 added, 1 copied, 3 duplicated, 1 date modified, 2 content modified, 2 deleted
```

<br/>
<br/>


# Real life example
---


## Initialize the big Fim repository

Here is the output of the initialization of a big Fim repository that contains 297 GB of photos and videos.<br/>
In my case **it takes 2 hours** to hash all the files content.

```shell
~/Photos_Videos$ fim init
2015/07/20 23:07:28 - Info  - Scanning recursively local files, hash the complete file, using 2 thread
(Hash progress legend for files grouped 10 by 10: # > 200 MB, @ > 100 MB, O > 50 MB, o > 20 MB, . otherwise)
.o#...........................................o@o...............OO.oO.......O.......................
@....o.......oo......................o..................Oo..........................................
......................................#.............................................................
oO........O........................@@...............................................................
............................O...o........o.oo...o.o..o.................o........o...................
....o.o................................Oo..oo..o@...........................o.......................
.................................O...@..............................................................
....................................................................................................
...........o.......O@..............O@@.................O.o........@.........Oo........O@O..o......OO
..@...O#o..o......o................@.........OO.....................................................
...............o.........oo.o................................o...............o......................
.........................oooooooo.ooo@..........................oooo................O...............
...oo....OoOo..o....oO@@o@..O..........oO...o@oOO#@@@oo.@@o.o@O.....@@@@@@OO@@@@OO..@@#....OooO.....
.........................Oo#oOOoo.O#O.....oo.....o.......oo........@oOO.@o....o................O....
...@o#OoOO..@Oo.O.o........@o.............ooo@.o...............oO...................................
....O..O.....Oo#oooooooo..oo@oo.ooo.oooooooooO@ooo#Ooo@Ooo.o.o.##@@ooooo@OoOOOo...o.O.@Ooooooooooooo
oooooOooo.ooooooOooooOOoo.######O@####oo#####oo...oooOoo...ooooooooooooo....o.@#@#@OOoooOo#ooooOOoo@
ooo#@#####ooo..#.##o@o.@@o##oooooooO.oooooo@##o#@....#oooo@oo#######o...o.ooooooo#oo@#ooO@###o#oooo#
OooooooooooooooOoooooo....ooooooooo.#oooooo.oOOOooo....................o..ooo.........o.ooo.........
oo.o...........@o@o@oooO@##o.oooo#@##oo@ooo@##O##oOooooooooo###@##@............###OOoO#o###ooOoooo#o
oOoo@oo..o.oo...................o@#..o@ooo@@....................................................O...
............o............ooooo..o.....................ooo.o........................ooo.....o.oo.....
...............ooo....................oooooooooooooo.oo.oooooooooooo#oo#oooooooooooooooooooo........
..oooo......o......o......o..................o...#.#####ooooooooOoOooooooooOooooooOOOOooOOOoOOooo###
#@OooooooO#####oOoooOOOOOOOoOOOoooooooOooooooooooooo###ooooooooooo#@OoOOOOOOOOoooooooooooooooOOoo#oO
ooooooooooOOOoooooOooOOoOOOOooOOoOOOooOooOoooOoOOoooOoOoooOOOoOo##..................................
..........................@oo......ooo.oooo@oooooooooOooooooooO##OOOOOoOOOOOOOOOOOOOO@###OOOoOOOOOO#
@@OOOo...........................................................####@.ooo.o...o#ooooo@ooo..ooooo...
.ooo.......................Oo........................oo..@.......O@......O..........................
.....................................................@................@O............................
..................................................##@.....................................#o#oooOooo
.......#oO############################################################@##########o....ooooooooooo.oo
ooooo.oooo.o.oooooooooooo......ooooooooooooooooooooooo.oooooooooo.oooooooooooooooooooooooooooooooooo
o......oooooooooooooo....oooooooooooooooooooooooooooooooooooooo.oooooooooooooooooooooooooooooooooooo
oooooooo.o.ooo..ooo.ooooooooooo...oo.o....o..ooooo.ooo...o.ooooooooooooooooooo.ooooooooooooooooooooo
oooooooooo....oooo.ooooooooooooooooo....o....ooo...o.....oo............o.......o.oo.ooooooooooooo.oo
oooooooooooooooooooooooooooooooooo.oooooooooooooooo.ooooooooooooooooooooo.....oooooooooooooooooooooo
oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo
oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo
oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo..oo
oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo
oooooooooooooooooo#ooooooooooo..oo@...ooooo#o
2015/07/21 01:11:54 - Info  - Scanned 41453 files (297 GB), hashed 297 GB (avg 41 MB/s), during 02:04:25, using 2 thread

... # File list is skipped as it is too long

41453 added
```

<br/>

## Check quickly for differences

It is possible to check the differences very quickly using the `-k` option that will check only the second 4 KB block.<br/>
In my case **it takes 4 minutes :=)**.

```shell
~/Photos_Videos$ fim diff -k
2015/07/21 08:49:21 - Info  - Scanning recursively local files, hash second 4 KB block, using 2 thread
(Hash progress legend for files grouped 10 by 10: # > 200 MB, @ > 100 MB, O > 50 MB, o > 20 MB, . otherwise)
.o#...........................................o@o...............OO.oO.......O.......................
@....o.......oo......................o..................Oo..........................................
......................................#.............................................................
oO........O........................@@...............................................................
............................O...o........o.oo...o.o..o.................o........o...................
....o.o................................Oo..oo..o@...........................o.......................
.................................O...@..............................................................
....................................................................................................
...........o.......O@..............O@@.................O.o........@.........Oo........O@O..o......OO
..@...O#o..o......o................@.........OO.....................................................
...............o.........oo.o................................o...............o......................
.........................oooooooo.ooo@..........................oooo................O...............
...oo....OoOo..o....oO@@o@..O..........oO...o@oOO#@@@oo.@@o.o@O.....@@@@@@OO@@@@OO..@@#....OooO.....
.........................Oo#oOOoo.O#O.....oo.....o.......oo........@oOO.@o....o................O....
...@o#OoOO..@Oo.O.o........@o.............ooo@.o...............oO...................................
....O..O.....Oo#oooooooo..oo@oo.ooo.oooooooooO@ooo#Ooo@Ooo.o.o.##@@ooooo@OoOOOo...o.O.@Ooooooooooooo
oooooOooo.ooooooOooooOOoo.######O@####oo#####oo...oooOoo...ooooooooooooo....o.@#@#@OOoooOo#ooooOOoo@
ooo#@#####ooo..#.##o@o.@@o##oooooooO.oooooo@##o#@....#oooo@oo#######o...o.ooooooo#oo@#ooO@###o#oooo#
OooooooooooooooOoooooo....ooooooooo.#oooooo.oOOOooo....................o..ooo.........o.ooo.........
oo.o...........@o@o@oooO@##o.oooo#@##oo@ooo@##O##oOooooooooo###@##@............###OOoO#o###ooOoooo#o
oOoo@oo..o.oo...................o@#..o@ooo@@....................................................O...
............o............ooooo..o.....................ooo.o........................ooo.....o.oo.....
...............ooo....................oooooooooooooo.oo.oooooooooooo#oo#oooooooooooooooooooo........
..oooo......o......o......o..................o...#.#####ooooooooOoOooooooooOooooooOOOOooOOOoOOooo###
#@OooooooO#####oOoooOOOOOOOoOOOoooooooOooooooooooooo###ooooooooooo#@OoOOOOOOOOoooooooooooooooOOoo#oO
ooooooooooOOOoooooOooOOoOOOOooOOoOOOooOooOoooOoOOoooOoOoooOOOoOo##..................................
..........................@oo......ooo.oooo@oooooooooOooooooooO##OOOOOoOOOOOOOOOOOOOO@###OOOoOOOOOO#
@@OOOo...........................................................####@.ooo.o...o#ooooo@ooo..ooooo...
.ooo.......................Oo........................oo..@.......O@......O..........................
.....................................................@................@O............................
..................................................##@.....................................#o#oooOooo
.......#oO############################################################@##########o....ooooooooooo.oo
ooooo.oooo.o.oooooooooooo......ooooooooooooooooooooooo.oooooooooo.oooooooooooooooooooooooooooooooooo
o......oooooooooooooo....oooooooooooooooooooooooooooooooooooooo.oooooooooooooooooooooooooooooooooooo
oooooooo.o.ooo..ooo.ooooooooooo...oo.o....o..ooooo.ooo...o.ooooooooooooooooooo.ooooooooooooooooooooo
oooooooooo....oooo.ooooooooooooooooo....o....ooo...o.....oo............o.......o.oo.ooooooooooooo.oo
oooooooooooooooooooooooooooooooooo.oooooooooooooooo.ooooooooooooooooooooo.....oooooooooooooooooooooo
oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo
oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo
oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo..oo
oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo
oooooooooooooooooo#ooooooooooo..oo@...ooooo#o
2015/07/21 08:53:47 - Info  - Scanned 41453 files (297 GB), hashed 161 MB (avg 622 KB/s), during 00:04:25, using 2 thread

Comparing with the last committed state from 2015/07/20 23:07:28
Comment: Initial State

Nothing modified
```

<br/>

## Check more accurately for differences

This quick diff can be inaccurate.<br/>
To increase accuracy, you can use the `-m` option. This result is more accurate,
but it cannot be completely accurate as only the hash of the second 1 MB block of the files are computed.<br/>
This time in my case, **it takes 20 minutes** to check the differences.

```shell
~/Photos_Videos$ fim diff -m
2015/07/21 12:45:24 - Info  - Scanning recursively local files, hash second 1 MB block, using 2 thread
(Hash progress legend for files grouped 10 by 10: # > 200 MB, @ > 100 MB, O > 50 MB, o > 20 MB, . otherwise)
.o#...........................................o@o...............OO.oO.......O.......................
@....o.......oo......................o..................Oo..........................................
......................................#.............................................................
oO........O........................@@...............................................................
............................O...o........o.oo...o.o..o.................o........o...................
....o.o................................Oo..oo..o@...........................o.......................
.................................O...@..............................................................
....................................................................................................
...........o.......O@..............O@@.................O.o........@.........Oo........O@O..o......OO
..@...O#o..o......o................@.........OO.....................................................
...............o.........oo.o................................o...............o......................
.........................oooooooo.ooo@..........................oooo................O...............
...oo....OoOo..o....oO@@o@..O..........oO...o@oOO#@@@oo.@@o.o@O.....@@@@@@OO@@@@OO..@@#....OooO.....
.........................Oo#oOOoo.O#O.....oo.....o.......oo........@oOO.@o....o................O....
...@o#OoOO..@Oo.O.o........@o.............ooo@.o...............oO...................................
....O..O.....Oo#oooooooo..oo@oo.ooo.oooooooooO@ooo#Ooo@Ooo.o.o.##@@ooooo@OoOOOo...o.O.@Ooooooooooooo
oooooOooo.ooooooOooooOOoo.######O@####oo#####oo...oooOoo...ooooooooooooo....o.@#@#@OOoooOo#ooooOOoo@
ooo#@#####ooo..#.##o@o.@@o##oooooooO.oooooo@##o#@....#oooo@oo#######o...o.ooooooo#oo@#ooO@###o#oooo#
OooooooooooooooOoooooo....ooooooooo.#oooooo.oOOOooo....................o..ooo.........o.ooo.........
oo.o...........@o@o@oooO@##o.oooo#@##oo@ooo@##O##oOooooooooo###@##@............###OOoO#o###ooOoooo#o
oOoo@oo..o.oo...................o@#..o@ooo@@....................................................O...
............o............ooooo..o.....................ooo.o........................ooo.....o.oo.....
...............ooo....................oooooooooooooo.oo.oooooooooooo#oo#oooooooooooooooooooo........
..oooo......o......o......o..................o...#.#####ooooooooOoOooooooooOooooooOOOOooOOOoOOooo###
#@OooooooO#####oOoooOOOOOOOoOOOoooooooOooooooooooooo###ooooooooooo#@OoOOOOOOOOoooooooooooooooOOoo#oO
ooooooooooOOOoooooOooOOoOOOOooOOoOOOooOooOoooOoOOoooOoOoooOOOoOo##..................................
..........................@oo......ooo.oooo@oooooooooOooooooooO##OOOOOoOOOOOOOOOOOOOO@###OOOoOOOOOO#
@@OOOo...........................................................####@.ooo.o...o#ooooo@ooo..ooooo...
.ooo.......................Oo........................oo..@.......O@......O..........................
.....................................................@................@O............................
..................................................##@.....................................#o#oooOooo
.......#oO############################################################@##########o....ooooooooooo.oo
ooooo.oooo.o.oooooooooooo......ooooooooooooooooooooooo.oooooooooo.oooooooooooooooooooooooooooooooooo
o......oooooooooooooo....oooooooooooooooooooooooooooooooooooooo.oooooooooooooooooooooooooooooooooooo
oooooooo.o.ooo..ooo.ooooooooooo...oo.o....o..ooooo.ooo...o.ooooooooooooooooooo.ooooooooooooooooooooo
oooooooooo....oooo.ooooooooooooooooo....o....ooo...o.....oo............o.......o.oo.ooooooooooooo.oo
oooooooooooooooooooooooooooooooooo.oooooooooooooooo.ooooooooooooooooooooo.....oooooooooooooooooooooo
oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo
oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo
oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo..oo
oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo
oooooooooooooooooo#ooooooooooo..oo@...ooooo#o
2015/07/21 13:05:04 - Info  - Scanned 41453 files (297 GB), hashed 35 GB (avg 30 MB/s), during 00:19:39, using 2 thread

Comparing with the last committed state from 2015/07/20 23:07:28
Comment: Initial State

Nothing modified
```

<br/>

## Fully checking for differences

If you want to be completely sure of the `diff` result, you need to run a full hash of all the files content using the `fim diff` command without any option.<br/>
This time in my case, **it takes 2 hours** as for the `init` command.

<br/>

## Checking without hashing

There is also the fast mode using the `-f` option that do not hash file content. It helps to detect faster changes but only file names that have changed.<br/>
This time in my case, **it takes 3 seconds**.


<br/>
<br/>


# FAQ
---

<br/>

## Run Fim commands from a sub-directory

You can run all the Fim commands from every directory inside the Fim repository.
It allows you to:
- Quickly find the modifications done in this directory. You will hash only the files contained inside and not the complete file tree
- Quickly commit the modifications done in this directory
- Quickly find the duplicated files contained in this directory
- Quickly reset the date of files contained in this directory

All the other commands will run as if you were on the top of the repository.

<br/>

## Dealing with duplicates

Duplicated files are addressed by Fim in two different ways.

### Duplicates inside a Fim repository

Fim allow you to detect duplicates using the `fdup` command.<br/>
If you want to remove them, Fim cannot do it. It does not provide a smart way to remove those duplicates.

<br/>

### Duplicates that are outside

You can use Fim to remove duplicated files that are located outside a Fim repository using the `rdup` command.<br/>
It can be useful if you want to cleanup old backups that are no more synchronized and you want to be sure to not loose any files that could have been modified or added.

<br/>

## Changing default hash mode

If you never want to hash the complete content of your files you can set a global hash mode that will indicate the maximum hash mode you want to use for this repository.
You can specify this to the init command:
- `-f`: means always don't hash anything
- `-k`: You will be able to use `-f` or `-k` after
- `-m`: You will be able to use `-f`, `-k` or `-m` after

Example:
```shell
~/sample$ fim init -m
```

It sets a global hash mode for the complete repository to `-m`.<br/>
All the Fim commands that you use after will use `-m` hash mode (or less if specified) and you won't be able to hash the full file content.
After you will be able to run the following commands:

```shell
~/sample$ fim diff # will run using -m

~/sample$ fim diff -k

~/sample$ fim diff -f
```

<br/>

## Hash files in multi-thread

Fim hash files using several threads.<br/>
This allow taking advantage of the computer resources and maximize the overall performances of file hashing.
By default, Fim use an arbitrary thread count that is the number of CPU cores divided by two.<br/>
You can specify the number of thread to be used for file hashing.<br/>
The best value depend on the kind of hard disk you have. The more throughput you have, the more thread you can use.

<br/>

## State integrity

All the States contains a hash of the State content.<br/>
If something is modified in the State, the hash of the State content will change and the State will be reported as corrupted.<br/>
Fim won't use it.

<br/>
<br/>
<br/>
<br/>
<br/>


# Fim requirements
---

> This tool is written in Java.

Fim is compiled using Java 8 and require Java 8 to run. You can download Java 8 from [here](http://www.oracle.com/technetwork/java/javase/downloads/index.html).<br/>
You need at least Java 8 Standard Edition JRE. You can also use the OpenJDK 8.

<br/>
<br/>


# About
---

> Forged by Etienne Vrignaud.

<br/>
<br/>


# License
---

This project is released under the [GPLv3 license](LICENSE.html), for more details, take a look at the LICENSE file in the source.

Basically, that allow you to use all or part of the project for you own business.

</xmp>

<script src="strapdown/ndossougbe.github.io-strapdown.js"></script>

<p>
    <a href="https://github.com/evrignaud/fim"><img
            style="position: fixed; top: 0; right: 0; border: 0; z-index: 1000; margin: 0;"
            src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png" alt="Fork me on GitHub"></a>
</p>

</body>
</html>
